global:
  gc: false
  waitWhenFinished: true
  measurements:
    - name: podLatency

jobs:
  - name: basic-hook-test
    jobType: create
    jobIterations: 5
    qps: 5
    burst: 5
    namespace: hook-test
    namespacedIterations: true
    verifyObjects: true
    
    # Hook configuration
    hooks:
      # Before deployment starts
      - cmd: ["/bin/bash", "test/hooks/simple-hook.sh", "beforeJobExecution"]
        when: beforeJobExecution
        background: false
      
      # After deployment completes
      - cmd: ["/bin/bash", "test/hooks/simple-hook.sh", "afterJobExecution"]
        when: afterJobExecution
        background: false
      
      # Before cleanup
      - cmd: ["/bin/bash", "test/hooks/simple-hook.sh", "beforeCleanup"]
        when: beforeCleanup
        background: false
      
      # On each iteration
      - cmd: ["/bin/bash", "test/hooks/simple-hook.sh", "onEachIteration"]
        when: onEachIteration
        background: false
  
    # Churn configuration
    churnConfig:
      duration: 30s
      percent: 20
      delay: 5s
      
    objects:
      - objectTemplate: objectTemplates/hooks-test.yaml
        replicas: 2
        inputVars:
          containerImage: busybox:latest
